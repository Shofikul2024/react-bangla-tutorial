### **React: Extracting State Logic into a Reducer**

In React, **state logic** refers to how you handle state updates based on user actions or other triggers. When this logic becomes complex (like managing multiple states or actions), you can **extract it into a reducer** for better organization and maintainability.

---

### **What is a Reducer?**

- A **reducer** is a function that takes two arguments:
  1. **Current State**: The state before the update.
  2. **Action**: An object describing what needs to change (e.g., `{ type: "increment", payload: 1 }`).
- The reducer returns the **new state** based on the action.

Reducers are commonly used with the `useReducer` hook in React, especially for managing **complex state logic**.

---

### **Why Use a Reducer?**

- **Centralized Logic**: Keeps all state logic in one place.
- **Predictable Updates**: State updates are determined by the reducer, making them easier to debug.
- **Scalability**: Helps manage complex states with multiple actions and updates.

---

### **Steps to Extract State Logic into a Reducer**

#### **1. Identify Complex State Logic**

Check if you have multiple related states or logic that’s difficult to manage with `useState`.

Example:

- State: A shopping cart with items.
- Logic: Add, remove, or update items.

#### **2. Write a Reducer Function**

Define the reducer function to handle the state logic.

#### **3. Use the `useReducer` Hook**

Replace multiple `useState` hooks with a single `useReducer` hook for managing state.

#### **4. Combine Context Providers**

If you’re using multiple contexts, you can integrate them with reducers for shared state.

---

### **Building a Fundamental App with Two Providers**

Let’s build a simple **shopping app** that:

- Uses two contexts: **UserContext** (user data) and **CartContext** (cart state).
- Extracts state logic for the cart into a reducer.
- Fetches user and product data from external files.

---

### **Step 1: Create the Data Files**

**`userData.js`**

```javascript
export const userData = {
  name: "Md. Mojnu Miah",
  email: "mojnu@example.com",
};
```

**`productData.js`**

```javascript
export const productData = [
  { id: 1, name: "Laptop", price: 500 },
  { id: 2, name: "Phone", price: 300 },
  { id: 3, name: "Headphones", price: 100 },
];
```

---

### **Step 2: Create Contexts**

**UserContext.js**

```javascript
import { createContext } from "react";

export const UserContext = createContext();
```

**CartContext.js**

```javascript
import { createContext } from "react";

export const CartContext = createContext();
```

---

### **Step 3: Write a Reducer for the Cart**

**cartReducer.js**

```javascript
export const cartReducer = (state, action) => {
  switch (action.type) {
    case "ADD_ITEM":
      return [...state, action.payload];
    case "REMOVE_ITEM":
      return state.filter((item) => item.id !== action.payload.id);
    default:
      throw new Error(`Unhandled action type: ${action.type}`);
  }
};
```

---

### **Step 4: Create Providers**

**UserProvider.js**

```javascript
import React from "react";
import { UserContext } from "./UserContext";
import { userData } from "../data/userData";

const UserProvider = ({ children }) => {
  return (
    <UserContext.Provider value={userData}>{children}</UserContext.Provider>
  );
};

export default UserProvider;
```

**CartProvider.js**

```javascript
import React, { useReducer } from "react";
import { CartContext } from "./CartContext";
import { cartReducer } from "../reducers/cartReducer";

const CartProvider = ({ children }) => {
  const [cart, dispatch] = useReducer(cartReducer, []); // Initial state is an empty array

  return (
    <CartContext.Provider value={{ cart, dispatch }}>
      {children}
    </CartContext.Provider>
  );
};

export default CartProvider;
```

---

### **Step 5: Wrap App with Providers**

**index.js**

```javascript
import React from "react";
import ReactDOM from "react-dom";
import App from "./App";
import UserProvider from "./contexts/UserProvider";
import CartProvider from "./contexts/CartProvider";

ReactDOM.render(
  <UserProvider>
    <CartProvider>
      <App />
    </CartProvider>
  </UserProvider>,
  document.getElementById("root")
);
```

---

### **Step 6: Consume Contexts in Components**

#### **Header.js**

Display user data from `UserContext`.

```javascript
import React, { useContext } from "react";
import { UserContext } from "../contexts/UserContext";

const Header = () => {
  const user = useContext(UserContext);

  return (
    <header style={{ padding: "10px", background: "#f0f0f0" }}>
      <h1>Welcome, {user.name}!</h1>
      <p>Email: {user.email}</p>
    </header>
  );
};

export default Header;
```

#### **ProductList.js**

Display products and allow adding them to the cart.

```javascript
import React, { useContext } from "react";
import { productData } from "../data/productData";
import { CartContext } from "../contexts/CartContext";

const ProductList = () => {
  const { dispatch } = useContext(CartContext);

  const addToCart = (product) => {
    dispatch({ type: "ADD_ITEM", payload: product });
  };

  return (
    <div>
      <h2>Products</h2>
      {productData.map((product) => (
        <div key={product.id}>
          <p>
            {product.name} - ${product.price}
          </p>
          <button onClick={() => addToCart(product)}>Add to Cart</button>
        </div>
      ))}
    </div>
  );
};

export default ProductList;
```

#### **Cart.js**

Display cart items and allow removing them.

```javascript
import React, { useContext } from "react";
import { CartContext } from "../contexts/CartContext";

const Cart = () => {
  const { cart, dispatch } = useContext(CartContext);

  const removeFromCart = (item) => {
    dispatch({ type: "REMOVE_ITEM", payload: item });
  };

  return (
    <div>
      <h2>Cart</h2>
      {cart.length === 0 ? (
        <p>Your cart is empty.</p>
      ) : (
        cart.map((item) => (
          <div key={item.id}>
            <p>
              {item.name} - ${item.price}
            </p>
            <button onClick={() => removeFromCart(item)}>Remove</button>
          </div>
        ))
      )}
    </div>
  );
};

export default Cart;
```

---

### **Step 7: Combine Everything**

**App.js**

```javascript
import React from "react";
import Header from "./components/Header";
import ProductList from "./components/ProductList";
import Cart from "./components/Cart";

const App = () => {
  return (
    <div>
      <Header />
      <ProductList />
      <Cart />
    </div>
  );
};

export default App;
```

---

### **How It Works**

1. **`useReducer`**: Manages the cart state and logic (add/remove items).
2. **Multiple Contexts**: `UserContext` provides user data, and `CartContext` manages the cart state.
3. **External Data**: `userData` and `productData` are imported and used in components.

---

### **Benefits**

- **Separation of Concerns**: State logic is in the reducer, not spread across components.
- **Scalability**: Multiple providers can work together seamlessly.
- **Reusability**: Reducer and contexts are modular and reusable.

Let me know if you need further clarification or enhancements!
